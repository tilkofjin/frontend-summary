<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nestjs | å‰ç«¯è‡ªå­¦æŒ‡å—</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/frontend-summary/img/headLogo.jpg">
    <meta name="description" content="å‰ç«¯å­¦ä¹ çš„å¿ƒè·¯å†ç¨‹">
    <link rel="preload" href="/frontend-summary/assets/css/0.styles.8996fafd.css" as="style"><link rel="preload" href="/frontend-summary/assets/js/app.b5f1b4da.js" as="script"><link rel="preload" href="/frontend-summary/assets/js/3.332dd64b.js" as="script"><link rel="preload" href="/frontend-summary/assets/js/20.9f755477.js" as="script"><link rel="prefetch" href="/frontend-summary/assets/js/10.cb36361a.js"><link rel="prefetch" href="/frontend-summary/assets/js/11.c6772edc.js"><link rel="prefetch" href="/frontend-summary/assets/js/12.d672fa33.js"><link rel="prefetch" href="/frontend-summary/assets/js/13.e2222a42.js"><link rel="prefetch" href="/frontend-summary/assets/js/14.c18e3c23.js"><link rel="prefetch" href="/frontend-summary/assets/js/15.cba0612b.js"><link rel="prefetch" href="/frontend-summary/assets/js/16.81fea3b7.js"><link rel="prefetch" href="/frontend-summary/assets/js/17.4f66820a.js"><link rel="prefetch" href="/frontend-summary/assets/js/18.cf9a34d7.js"><link rel="prefetch" href="/frontend-summary/assets/js/19.f2f5cc9b.js"><link rel="prefetch" href="/frontend-summary/assets/js/21.e15f94d6.js"><link rel="prefetch" href="/frontend-summary/assets/js/4.cbcf3cb5.js"><link rel="prefetch" href="/frontend-summary/assets/js/5.f053a152.js"><link rel="prefetch" href="/frontend-summary/assets/js/6.bbc48170.js"><link rel="prefetch" href="/frontend-summary/assets/js/7.18824614.js"><link rel="prefetch" href="/frontend-summary/assets/js/8.4516358a.js"><link rel="prefetch" href="/frontend-summary/assets/js/9.2cd21853.js"><link rel="prefetch" href="/frontend-summary/assets/js/vendors~docsearch.f5584d80.js">
    <link rel="stylesheet" href="/frontend-summary/assets/css/0.styles.8996fafd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/frontend-summary/zh/" class="home-link router-link-active"><img src="/frontend-summary/img/searchLogo.jpg" alt="å‰ç«¯è‡ªå­¦æŒ‡å—" class="logo"> <span class="site-name can-hide">å‰ç«¯è‡ªå­¦æŒ‡å—</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/frontend-summary/zh/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/frontend-summary/zh/basics/" class="nav-link">
  å‰ç«¯åŸºç¡€
</a></div><div class="nav-item"><a href="/frontend-summary/zh/guide/" class="nav-link router-link-active">
  è¿›é˜¶æŒ‡å—
</a></div><div class="nav-item"><a href="https://github.com/tilkofjin" target="_self" rel="" class="nav-link external">
  Github
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend-summary/guide/nestjs.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/frontend-summary/zh/guide/nestjs.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  ç®€ä½“ä¸­æ–‡
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/frontend-summary/zh/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/frontend-summary/zh/basics/" class="nav-link">
  å‰ç«¯åŸºç¡€
</a></div><div class="nav-item"><a href="/frontend-summary/zh/guide/" class="nav-link router-link-active">
  è¿›é˜¶æŒ‡å—
</a></div><div class="nav-item"><a href="https://github.com/tilkofjin" target="_self" rel="" class="nav-link external">
  Github
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend-summary/guide/nestjs.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/frontend-summary/zh/guide/nestjs.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  ç®€ä½“ä¸­æ–‡
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/frontend-summary/zh/guide/nodejs.html" class="sidebar-link">Nodejs</a></li><li><a href="/frontend-summary/zh/guide/nestjs.html" aria-current="page" class="active sidebar-link">Nestjs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend-summary/zh/guide/nestjs.html#æ§åˆ¶å™¨" class="sidebar-link">æ§åˆ¶å™¨</a></li><li class="sidebar-sub-header"><a href="/frontend-summary/zh/guide/nestjs.html#æä¾›è€…" class="sidebar-link">æä¾›è€…</a></li><li class="sidebar-sub-header"><a href="/frontend-summary/zh/guide/nestjs.html#æ¨¡å—" class="sidebar-link">æ¨¡å—</a></li><li class="sidebar-sub-header"><a href="/frontend-summary/zh/guide/nestjs.html#ä¸­é—´ä»¶" class="sidebar-link">ä¸­é—´ä»¶</a></li></ul></li><li><a href="/frontend-summary/zh/guide/ci.html" class="sidebar-link">CI</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="nestjs-å¼€å‘æŒ‡å—"><a href="#nestjs-å¼€å‘æŒ‡å—" class="header-anchor">#</a> Nestjs å¼€å‘æŒ‡å—</h1> <ul><li>æ¡†æ¶ä»‹ç»</li></ul> <blockquote><p>Nestæ˜¯ç›®å‰ä¸ºæ­¢ä¸ªäººè®¤ä¸ºæœ€ä¼˜ç§€çš„æ¸è¿›å¼<a href="http://nodejs.org" target="_blank">Node.js</a> ä¼ä¸šçº§æ¡†æ¶ï¼Œä½¿ç”¨ <a href="http://www.typescriptlang.org" target="_blank">TypeScript</a>æ„å»ºå¹¶ä¿è¯äº†ä¸åŸç”ŸJSçš„å…¼å®¹æ€§ï¼Œå¹¶ç»“åˆäº† OOPï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰ï¼ŒFPï¼ˆå‡½æ•°å¼ç¼–ç¨‹ï¼‰å’Œ FRPï¼ˆå‡½æ•°å¼å“åº”ç¼–ç¨‹ï¼‰çš„å…ƒç´ ï¼Œæœ‰ç‚¹ç±»ä¼¼ JAVA çš„ sprinboot æ¡†æ¶çš„æ ¸å‹æ€æƒ³ã€‚æ˜¯ç›®å‰å‰ç«¯å·¥ç¨‹å¸ˆæ„å»ºå¤§å‹å…¨æ ˆé¡¹ç›®çš„æœ€å¥½é€‰æ‹©ã€‚</p></blockquote> <blockquote><p>ç¯å¢ƒè¦æ±‚--ç¡®ä¿æœ¬åœ°<a href="http://nodejs.org" target="_blank">Node.js</a>(&gt;= 10.13.0)</p></blockquote> <ul><li><p>è¿™é‡Œåªåšå¸¸ç”¨åŠŸèƒ½æ¨¡å—çš„åŸºç¡€ä»‹ç»ï¼Œè¯¦ç»†ä¿¡æ¯<a href="https://docs.nestjs.cn" target="_blank" rel="noopener noreferrer">è¯·æŸ¥çœ‹ä¸­æ–‡æŒ‡å—<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. ğŸ“š</p></li> <li><p>å…¨å±€å®‰è£…</p></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>  $ <span class="token function">npm</span> i -g @nestjs/cli
  $ nest new project-name
</code></pre></div><h2 id="æ§åˆ¶å™¨"><a href="#æ§åˆ¶å™¨" class="header-anchor">#</a> æ§åˆ¶å™¨</h2> <p><img src="https://docs.nestjs.com/assets/Controllers_1.png" alt="img" title="æ§åˆ¶å™¨"></p> <blockquote><p>è´Ÿè´£å¤„ç†ä¼ å…¥çš„ <strong>è¯·æ±‚</strong> å’Œå‘å®¢æˆ·ç«¯è¿”å› <strong>å“åº”</strong> ï¼Œé€šç†Ÿç‚¹æˆ‘ç†è§£ä¸ºï¼Œå…¨å±€è¯·æ±‚ã€å“åº”è·¯ç”±æ§åˆ¶ï¼Œé€šè¿‡TSçš„è£…é¥°å™¨å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†ç±»ä¸æ•°æ®è¿›è¡Œå…³è”ï¼Œå¹¶ä½¿neståˆ›å»ºè·¯ç”±æ˜ å°„å°†æ•°æ®ç»‘å®šåˆ°ç›¸åº”çš„æ§åˆ¶å™¨ã€‚</p></blockquote> <h3 id="è·¯ç”±"><a href="#è·¯ç”±" class="header-anchor">#</a> è·¯ç”±</h3> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹:</p> <div class="language- extra-class"><pre><code>cats.controller.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'This action returns all cats'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é€šè¿‡ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨Controllerè£…é¥°å™¨ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å†™ä¸€ä¸ªcatsçš„æ§åˆ¶å™¨æ¨¡å—ï¼Œä¸€ä¸ªç®€å•çš„Getè¯·æ±‚ä¹Ÿå¯ä»¥é€šè¿‡è£…é¥°å™¨è½»æ¾å®ç°ã€‚å…¨å±€å®‰è£…è¿‡ <code>nest cli</code> åï¼Œåˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨ä¹Ÿå˜å¾—éå¸¸å®¹æ˜“</p> <div class="custom-block tip"><p class="custom-block-title">åˆ›å»ºcatsæ§åˆ¶å™¨</p> <div class="language- extra-class"><pre><code>$ nest g controller cats
</code></pre></div></div> <p>ä½¿ç”¨æ—¶è¯·æŒ‰ç…§å®˜æ–¹æ¨èçš„æ–¹å¼ï¼Œè¿™æ ·èƒ½é¿å…èµ°å¾ˆå¤šå¼¯è·¯ã€‚</p> <h3 id="è¯·æ±‚å¯¹è±¡ï¼ˆrequestï¼‰"><a href="#è¯·æ±‚å¯¹è±¡ï¼ˆrequestï¼‰" class="header-anchor">#</a> è¯·æ±‚å¯¹è±¡ï¼ˆrequestï¼‰</h3> <p>ç¨‹åºçš„è®¸å¤šè¯·æ±‚éœ€è¦è®¿é—®å®¢æˆ·ç«¯çš„è¯¦æƒ…ä¿¡æ¯ï¼ŒNestæä¾›å¯¹åŸºç¡€å¹³å°çš„è¯·æ±‚å¯¹è±¡çš„è®¿é—®ï¼Œæˆ‘å€‘å¯ä»¥é€šéåœ¨è™•ç†ç¨‹åºçš„ç°½åä¸­æ·»åŠ  <code>@Req()</code> è£é£¾å™¨ä¾†æŒ‡ç¤ºNestæ³¨å…¥è«‹æ±‚å°è±¡ï¼Œå¾è€Œè¨ªå•è©²è«‹æ±‚å°è±¡ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">Requestè¯·æ±‚</p> <div class="language- extra-class"><pre><code>cats.controller.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Req <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Request <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">findAll</span><span class="token punctuation">(</span>@<span class="token function">Req</span><span class="token punctuation">(</span><span class="token punctuation">)</span> request<span class="token operator">:</span> Request<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'This action returns all cats'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">å®‰è£…ç±»å‹æ”¯æŒ</p> <p>ä¸Šé¢çš„<code>Request</code>ä¹Ÿå¯ä»¥è·å–åˆ°å‚æ•°æç¤ºï¼Œåªéœ€å®‰è£… <code>@types/express</code> åŒ…å³å¯ã€‚</p></div> <p><code>Request</code> å¯¹è±¡è¡¨ç¤º HTTP è¯·æ±‚ï¼Œå¹¶å…·æœ‰ <code>Request</code> æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°ï¼ŒHTTP æ ‡å¤´ å’Œ æ­£æ–‡çš„å±æ€§ï¼Œä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹, ä¸å¿…æ‰‹åŠ¨è·å–å®ƒä»¬ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸“ç”¨çš„è£…é¥°å™¨ï¼Œæ¯”å¦‚ <code>@Body()</code> æˆ– <code>@Query()</code>ã€‚å…·ä½“è¯¦æƒ…ä¸åšç»†è¯´ï¼Œè£…é¥°å™¨å’Œæ™®é€šè¡¨è¾¾å¯¹è±¡çš„æ¯”è¾ƒè¯·çœ‹ <a href="https://docs.nestjs.com/controllers#request-object" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚è£…é¥°å™¨çš„å†™æ³•æ›´ä¼˜é›…ï¼Œä¹Ÿæ›´ç¬¦åˆTSçš„ä¹¦å†™è§„èŒƒã€‚</p> <hr> <p>ä¸ºäº†ä¸åº•å±‚ <code>HTTP</code>å¹³å°(å¦‚ <code>Express</code>å’Œ <code>Fastify</code>)ä¹‹é—´çš„ç±»å‹å…¼å®¹ï¼Œ<code>Nest</code> æä¾›äº† <code>@Res()</code>å’Œ <code>@Response()</code> è£…é¥°å™¨ã€‚<code>@Res()</code>åªæ˜¯ <code>@Response()</code>çš„åˆ«åã€‚ä¸¤è€…éƒ½ç›´æ¥å…¬å¼€åº•å±‚å“åº”å¯¹è±¡æ¥å£ã€‚åœ¨ä½¿ç”¨å®ƒä»¬æ—¶æ‚¨è¿˜åº”è¯¥å¯¼å…¥åº•å±‚åº“çš„ç±»å‹(ä¾‹å¦‚ï¼š<code>@types/express</code>)ä»¥å……åˆ†åˆ©ç”¨å®ƒä»¬ã€‚æ³¨æ„ï¼Œåœ¨æ–¹æ³•å¤„ç†ç¨‹åºä¸­æ³¨å…¥ <code>@Res()</code>æˆ– <code>@Response()</code> æ—¶ï¼Œå°† <code>Nest</code>ç½®äºè¯¥å¤„ç†ç¨‹åºçš„ç‰¹å®šäºåº“çš„æ¨¡å¼ä¸­ï¼Œå¹¶è´Ÿè´£ç®¡ç†å“åº”ã€‚è¿™æ ·åšæ—¶ï¼Œå¿…é¡»é€šè¿‡è°ƒç”¨å“åº”å¯¹è±¡(ä¾‹å¦‚ï¼Œ<code>res.json(â€¦)</code>æˆ– <code>res.send(â€¦)</code>)å‘å‡ºæŸç§å“åº”ï¼Œå¦åˆ™HTTPæœåŠ¡å™¨å°†æŒ‚èµ·ã€‚</p> <h3 id="èµ„æº"><a href="#èµ„æº" class="header-anchor">#</a> èµ„æº</h3> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>cats.controller.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'This action adds a new cat'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'This action returns all cats'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Nestä»¥ç›¸åŒçš„æ–¹å¼æä¾›å…¶é¤˜çš„æ¨™æº–HTTPè«‹æ±‚ç«¯é»è£é£¾å™¨ <code>@Put()ï¼Œ@ Delete()ï¼Œ@Patch()ï¼Œ@Options()ï¼Œ@Head(), @All()</code>ã€‚æ¯å€‹ä»£è¡¨å„è‡ªçš„HTTPè«‹æ±‚æ–¹æ³•ã€‚</p> <h3 id="è·¯ç”±é€šé…ç¬¦"><a href="#è·¯ç”±é€šé…ç¬¦" class="header-anchor">#</a> è·¯ç”±é€šé…ç¬¦</h3> <p>è·¯ç”±è¿˜æ”¯æŒæ¨¡å¼åŒ¹é…ã€‚ç±»ä¼¼ <code>*</code> è¢«ç”¨ä½œé€šé…ç¬¦ï¼Œå°†åŒ¹é…ä»»ä½•å­—ç¬¦ç»„åˆ, ä¾‹å¦‚ï¼š</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">'ab*cd'</span><span class="token punctuation">)</span>
<span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'This route uses a wildcard'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>ab * cd</code> è·¯ç”±è·¯å¾„å°†åŒ¹é… ab å¼€å¤´ cd ç»“å°¾çš„å­—ç¬¦, <code>?, +, *, ()</code> ä¹Ÿå¯ä»¥ä½¿ç”¨ä½œä¸ºå…¶æ­£å‰‡è¡¨é”å¼å°åº”é¡¹çš„å­é›†ã€‚è¿å­—ç¬¦ <code>-</code> å’Œç‚¹ <code>.</code> æŒ‰å­—ç¬¦ä¸²è·¯å¾„è§£æã€‚</p> <h3 id="çŠ¶æ€ç "><a href="#çŠ¶æ€ç " class="header-anchor">#</a> çŠ¶æ€ç </h3> <p>POSTè¯·æ±‚é»˜è®¤ä¸º <code>201</code> ï¼Œå…¶ä»–è¯·æ±‚é»˜è®¤è¿”å› <code>200</code> ä½œä¸ºçŠ¶æ€ç ï¼Œæˆ‘ä»¬ä¸»è¦é€šè¿‡ <code>@HttpCode</code> è£…é¥°å™¨æ¥å¤„ç†æˆ‘ä»¬çš„éœ€æ±‚æ‰€åº”è¯¥è¿”å›çš„çŠ¶æ€ç ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">HttpCode</span><span class="token punctuation">(</span><span class="token number">204</span><span class="token punctuation">)</span>
<span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'This action adds a new cat'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>çŠ¶æ€ç æ˜¯å¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚çš„éœ€è¦è‡ªç”±å®šä¹‰ï¼Œé€šè¿‡ <code>@Res()</code> æ³¨å…¥ï¼Œå¹¶åœ¨ç¨‹åºé”™è¯¯æ—¶æŠ›å‡ºå¼‚å¸¸ã€‚</p> <h3 id="å“åº”å¤´"><a href="#å“åº”å¤´" class="header-anchor">#</a> å“åº”å¤´</h3> <p>è¦æŒ‡å®šè‡ªå®šä¹‰çš„å“åº”å¤´ï¼Œå¯ä»¥é€šè¿‡è£…é¥°å™¨ <code>@Header()</code> æ¥å®ç°ã€‚å®ƒä¼šç›´æ¥è°ƒç”¨ <code>res.header()</code>ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">'Cache-Control'</span><span class="token punctuation">,</span> <span class="token string">'none'</span><span class="token punctuation">)</span>
<span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'This action adds a new cat'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="header-anchor">#</a> é‡å®šå‘</h3> <p>ä½¿ç”¨ <code>@Redirect()</code> è£…é¥°å™¨ï¼Œ<code>@Redirect()</code>çš„å¸¦å‚ä¸ºä¸€ä¸ªå¿…ä¼ çš„ <code>URL</code> ï¼Œå’Œä¸€ä¸ªå¯é€‰çš„ <code>statusCode</code> ï¼Œè‹¥ <code>statusCode</code> çœç•¥åˆ™é»˜è®¤ä¸º <code>302</code></p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">Redirect</span><span class="token punctuation">(</span><span class="token string">'https://nestjs.com'</span><span class="token punctuation">,</span> <span class="token number">301</span><span class="token punctuation">)</span>
</code></pre></div><p>æœ‰æ—¶å› ä¸šåŠ¡éœ€è¦åŠ¨æ€çš„ <code>statusCode</code> å’Œ <code>URL</code> ï¼Œé€šè¿‡ä»è·¯ç”±å¤„ç†ç¨‹åºæ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå½¢çŠ¶ä¸ºä»¥ä¸‹å½¢å¼çš„å¯¹è±¡ï¼š</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token property">&quot;statusCode&quot;</span><span class="token operator">:</span> number
<span class="token punctuation">}</span>
</code></pre></div><p>è¿”å›çš„å€¼å°‡è¦†è“‹ä¼ é€’çµ¦ <code>@Redirect()</code> è£é£¾å™¨çš„æ‰€æœ‰åƒæ•¸ï¼Œä¾‹ï¼š</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">'docs'</span><span class="token punctuation">)</span>
@<span class="token function">Redirect</span><span class="token punctuation">(</span><span class="token string">'https://docs.nestjs.com'</span><span class="token punctuation">,</span> <span class="token number">302</span><span class="token punctuation">)</span>
<span class="token function">getDocs</span><span class="token punctuation">(</span>@<span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">'version'</span><span class="token punctuation">)</span> version<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>version <span class="token operator">&amp;&amp;</span> version <span class="token operator">===</span> <span class="token string">'5'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> url<span class="token operator">:</span> <span class="token string">'https://docs.nestjs.com/v5/'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="è·¯ç”±å‚æ•°"><a href="#è·¯ç”±å‚æ•°" class="header-anchor">#</a> è·¯ç”±å‚æ•°</h3> <p>å½“éœ€è¦æ¥å—å‹•æ…‹æ•¸æ“šä½œç‚ºè«‹æ±‚çš„ä¸€éƒ¨åˆ†æ™‚ï¼Œå¸¶æœ‰éœæ…‹è·¯å¾‘çš„è·¯ç”±å°‡ä¸èµ·ä½œç”¨ï¼ˆä¾‹ï¼šä½¿ç”¨<code>GET</code>è¯·æ±‚ <code>/cats/1</code> æ¥è·å– idä¸º 1çš„ <code>cat</code>ï¼‰ï¼Œä¸ºäº†å®šä¹‰å¸¦å‚æ•°çš„è·¯ç”±ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è·¯ç”±ä¸­æ·»åŠ è·¯ç”±å‚æ•°<strong>æ ‡è®°</strong>,æ¥è·å–è¯·æ±‚URLä¸­è¯¥ä½ç½®çš„åŠ¨æ€å€¼ã€‚<code>@Get</code> ä¸‹é¢çš„è£…é¥°å™¨ç¤ºä¾‹ä¸­çš„è·¯ç”±å‚æ•°æ ‡è®°æ¼”ç¤ºäº†æ­¤æ–¹æ³•ã€‚å¯ä»¥ä½¿ç”¨ <code>@Param()</code> è£é£¾å™¨è¨ªå•ä»¥é€™ç¨®æ–¹å¼å£°æ˜çš„è·¯ç”±å‚æ•°ï¼Œè¯¥è£…é¥°å™¨åº”æ·»åŠ åˆ°å‡½æ•°ç­¾åä¸­ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
<span class="token function">findOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token punctuation">)</span> params<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This action returns a #</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šä¾‹ä¸­çš„ <code>@Param()</code> ç”¨æ¥è£…é¥°æ–¹æ³•çš„å‚æ•°ï¼Œå¹¶ä½¿è·¯ç”±å‚æ•°å¯ç”¨ä½œè¯¥ä¿®é¥°çš„æ–¹æ³•å‚æ•°åœ¨æ–¹æ³•ä½“å†…çš„å±æ€§ã€‚å¯ä»¥é€šéå¼•ç”¨ <code>params.id</code> ä¾†è¨ªå• <code>id</code> åƒæ•¸, è¿˜å¯ä»¥å°‡ç‰¹å®šçš„åƒæ•¸æ¨™è¨˜å‚³éçµ¦è£é£¾å™¨ï¼Œç„¶å¾Œåœ¨æ–¹æ³•ä¸»é«”ä¸­æŒ‰åç¨±ç›´æ¥å¼•ç”¨è·¯ç”±åƒæ•¸ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
<span class="token function">findOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> id<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This action returns a #</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å­åŸŸè·¯ç”±"><a href="#å­åŸŸè·¯ç”±" class="header-anchor">#</a> å­åŸŸè·¯ç”±</h3> <p><code>@Controller</code> è£é£¾å™¨å¯ä»¥æ¡ç”¨ <code>host</code> é¸é …ï¼Œä»¥è¦æ±‚ä¼ å…¥è¯·æ±‚çš„ HTTP ä¸»æœºåŒ¹é…æŸä¸ªç‰¹å®šå€¼ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">{</span> host<span class="token operator">:</span> <span class="token string">'admin.example.com'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AdminController</span> <span class="token punctuation">{</span>
  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'Admin page'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">è­¦å‘Š</p> <p>ç”±æ–¼ <code>Fastify</code> ç¼ºä¹å°åµŒå¥—è·¯ç”±å™¨çš„æ”¯æŒï¼Œå› æ­¤åœ¨ä½¿ç”¨å­è·¯ç”±æ™‚ï¼Œæ‡‰ä½¿ç”¨ï¼ˆé»˜èªï¼‰Expressé©é…å™¨</p></div> <p>ä¸è·¯ç”±ç±»ä¼¼ï¼Œ<code>hosts</code> é€‰é¡¹å¯ä»¥ä½¿ç”¨ä»¤ç‰Œæ¥æ•è·ä¸»æœºåä¸­è¯¥ä½ç½®çš„åŠ¨æ€å€¼,ä¸‹é¢çš„ <code>@Controller()</code> è£…é¥°å™¨ç¤ºä¾‹ä¸­çš„ä¸»æœºå‚æ•°ä»¤ç‰Œæ¼”ç¤ºäº†æ­¤ç”¨æ³•,å¯ä»¥ä½¿ç”¨ <code>@HostParam()</code> è£é£¾å™¨è¨ªå•ä»¥é€™ç¨®æ–¹å¼è²æ˜çš„ä¸»æ©Ÿåƒæ•¸,è¯¥è£…é¥°å™¨åº”æ·»åŠ åˆ°æ–¹æ³•ç­¾åä¸­ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">{</span> host<span class="token operator">:</span> <span class="token string">':account.example.com'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AccountController</span> <span class="token punctuation">{</span>
  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">getInfo</span><span class="token punctuation">(</span>@<span class="token function">HostParam</span><span class="token punctuation">(</span><span class="token string">'account'</span><span class="token punctuation">)</span> account<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> account<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="header-anchor">#</a> ä½œç”¨åŸŸ</h3> <p><code>Node.js</code> ä¸éµå¾ªè¯·æ±‚/å“åº”å¤šçº¿ç¨‹æ— çŠ¶æ€æ¨¡å‹ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ç”±ä¸»çº¿ç¨‹å¤„ç†ã€‚å› æ­¤ï¼Œä½¿ç”¨å•ä¾‹å¯¹æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ¥è¯´æ˜¯å®Œå…¨å®‰å…¨çš„ã€‚å…·ä½“ä½¿ç”¨è¯·çœ‹å®˜æ–¹ <a href="https://docs.nestjs.com/fundamentals/injection-scopes" target="_blank" rel="noopener noreferrer">æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ğŸ“š</p> <h3 id="å¼‚æ­¥ï¼ˆasync-awaitï¼‰"><a href="#å¼‚æ­¥ï¼ˆasync-awaitï¼‰" class="header-anchor">#</a> å¼‚æ­¥ï¼ˆasync / awaitï¼‰</h3> <p>ç”±äºè¯·æ±‚å¤§å¤šéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå¼‚æ­¥ç¼–ç¨‹å¸¦æ¥çš„å¥½å¤„ä¸å¿…å¤šè¯´</p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>cats.controller.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é™¤ä¸Šé¢çš„æ¼”ç¤ºå¤–ï¼Œé€šè¿‡è¿”å› RxJS <a href="http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html" target="_blank" rel="noopener noreferrer">observableæµ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ä½¿nestè·¯ç”±å¤„ç†æ›´å¼ºå¤§ã€‚åœ¨æµå®Œæˆåï¼Œnestå°†è‡ªåŠ¨è®¢é˜…ä¸‹é¢çš„æºå¹¶è·å–æœ€åå‘å‡ºçš„å€¼ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>cats.controller.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šé¢çš„ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥ä½¿ç”¨, é€‰æ‹©ä½ å–œæ¬¢çš„æ–¹å¼å³å¯ã€‚</p> <h3 id="è¯·æ±‚è´Ÿè½½"><a href="#è¯·æ±‚è´Ÿè½½" class="header-anchor">#</a> è¯·æ±‚è´Ÿè½½</h3> <p>ä¹‹å‰çš„ <code>POST</code> è·¯ç”±å¤„ç†ç¨‹åºä¸æ¥å—ä»»ä½•å®¢æˆ·ç«¯å‚æ•°ã€‚åœ¨è¿™é‡Œæ·»åŠ  <code>@Body()</code> å‚æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
é¦–å…ˆè¦ç¡®å®š <code>DTO(æ•°æ®ä¼ è¾“å¯¹è±¡)</code> æ¨¡å¼ã€‚<code>DTO</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•é€šè¿‡ç½‘ç»œå‘é€æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>TypeScript</code> æ¥å£æˆ–ç®€å•çš„ç±»æ¥å®Œæˆã€‚ç”±äº <code>TypeScript</code> æ¥å£åœ¨è½¬æ¢è¿‡ç¨‹ä¸­è¢«åˆ é™¤ï¼Œæ‰€ä»¥ <code>Nest</code> ä¸èƒ½åœ¨è¿è¡Œæ—¶å¼•ç”¨å®ƒä»¬ã€‚å› ç‚ºç®¡é“ç­‰åŠŸèƒ½åœ¨é‹è¡Œæ™‚å¯ä»¥è¨ªå•è®Šé‡çš„å…ƒé¡å‹æ™‚,æä¾›äº†æ›´å¤šçš„å¯èƒ½æ€§ã€‚</p> <blockquote><p>æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª <code>CreateCatDto</code> ç±»</p></blockquote> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>create-cat.dto.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CreateCatDto</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šä¾‹ä¸­çš„ç±»åªæœ‰ä¸‰ä¸ªå±æ€§ï¼Œæ­¤å¾Œï¼Œæˆ‘å€‘å¯ä»¥åœ¨ <code>CatsController</code> ä¸­ä½¿ç”¨æ–°å‰µå»ºçš„ <code>DTO</code>ï¼š</p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>cats.controller.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'This action adds a new cat'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="header-anchor">#</a> é”™è¯¯å¤„ç†</h3> <p>å…·ä½“çš„é”™è¯¯å¤„ç†ï¼Œè¯·çœ‹<a href="https://docs.nestjs.com/exception-filters" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ğŸ“š æœ‰å•ç‹¬çš„ç›¸å…³ä»‹ç»ã€‚</p> <h3 id="å®Œæ•´ç¤ºä¾‹"><a href="#å®Œæ•´ç¤ºä¾‹" class="header-anchor">#</a> å®Œæ•´ç¤ºä¾‹</h3> <p>ä¸‹é¢æ˜¯ä½¿ç”¨å‡ ä¸ªè£…é¥°å™¨åˆ›å»ºçš„æ§åˆ¶å™¨çš„ç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹å±•ç¤ºäº†æ§åˆ¶å™¨æä¾›çš„å‡ ç§è®¿é—®å’Œæ“ä½œå†…éƒ¨æ•°æ®çš„æ–¹æ³•ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>cats.controller.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Query<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Body<span class="token punctuation">,</span> Put<span class="token punctuation">,</span> Param<span class="token punctuation">,</span> Delete <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateCatDto<span class="token punctuation">,</span> UpdateCatDto<span class="token punctuation">,</span> ListAllEntities <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto'</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'This action adds a new cat'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span> query<span class="token operator">:</span> ListAllEntities</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This action returns all cats (limit: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>query<span class="token punctuation">.</span>limit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> items)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token function">findOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This action returns a #</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Put</span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token function">update</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> @<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> updateCatDto<span class="token operator">:</span> UpdateCatDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This action updates a #</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token function">remove</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This action removes a #</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> cat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹å‡ºé€šè¿‡è£…é¥°å™¨å¾ˆå®¹æ˜“å°±å®Œæˆäº†ä¸€ä¸ªåŸºç¡€çš„ CRUD æ¥å£ã€‚</p> <h3 id="å¼€å§‹è¿è¡Œ"><a href="#å¼€å§‹è¿è¡Œ" class="header-anchor">#</a> å¼€å§‹è¿è¡Œ</h3> <p>å®Œæˆä¸Šè¿°æ§åˆ¶å™¨çš„å®šä¹‰åï¼Œ<code>Nest</code> ä»ç„¶ä¸çŸ¥é“ <code>CatsController</code> å­˜åœ¨ã€‚
å› æ­¤ä¸æœƒå‰µå»ºæ­¤é¡çš„å¯¦ä¾‹,æ§åˆ¶å™¨å§‹çµ‚å±¬æ–¼æ¨¡å¡Šï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå°† <code>controllers</code> æ•°ç»„ä¿å­˜åœ¨ <code>@module()</code> è£…é¥°å™¨ä¸­, ç”±äºé™¤äº†æ ¹ <code>ApplicationModule</code>ï¼Œæˆ‘ä»¬æ²¡æœ‰å…¶ä»–æ¨¡å—ï¼Œæ‰€ä»¥å°†ä½¿ç”¨å®ƒæ¥ä»‹ç» <code>CatsController</code>:</p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>app.module.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats/cats.controller'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsController<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>ä½¿ç”¨ <code>@Module()</code> è£é£¾å™¨å°‡å…ƒæ•¸æ“šé™„åŠ åˆ°é¡¹ç›®çš„æ¨¡å¡Šé¡ä¸­ï¼Œ<code>Nest</code> ç°åœ¨å¯ä»¥è¼•é¬†åæ˜ å¿…é ˆå®‰è£å“ªäº›æ§åˆ¶å™¨ã€‚</p> <hr> <h3 id="é™„å½•ï¼šç±»åº“çš„ç‰¹æœ‰æ–¹å¼"><a href="#é™„å½•ï¼šç±»åº“çš„ç‰¹æœ‰æ–¹å¼" class="header-anchor">#</a> é™„å½•ï¼šç±»åº“çš„ç‰¹æœ‰æ–¹å¼</h3> <p>ä»¥ä¸Šä¸»è¦è®²è¿°æ˜¯nestæ ‡å‡†çš„æ–¹æ³•å¤„ç†çš„å“åº”æ–¹å¼ï¼Œè¿™é‡Œç®€å•è®²è¿°ï¼Œè¿˜ä»¥ä¸Šè¿°çš„ <code>CatsController</code> ä¸ºä¾‹é‡å¯«ç‚ºä»¥ä¸‹å…§å®¹ï¼š</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Res<span class="token punctuation">,</span> HttpStatus <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Response <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Res</span><span class="token punctuation">(</span><span class="token punctuation">)</span> res<span class="token operator">:</span> Response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>HttpStatus<span class="token punctuation">.</span><span class="token constant">CREATED</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Res</span><span class="token punctuation">(</span><span class="token punctuation">)</span> res<span class="token operator">:</span> Response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>HttpStatus<span class="token punctuation">.</span><span class="token constant">OK</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>è¿™é‡Œåªåšç®€å•å®˜æ–¹å¼•è¿°ï¼Œç±»åº“çš„ç‰¹æœ‰æ–¹å¼ä»å®˜æ–¹çš„ç¤ºä¾‹å¯å·²çœ‹å‡ºï¼Œé€»è¾‘å¹¶ä¸æ¸…æ™°ï¼Œå› æ­¤å»ºè®®åœ¨ä»»ä½•æ—¶å€™éƒ½é‡‡ç”¨nestçš„æ ‡å‡†æ¨¡å¼ã€‚
ä»¥ä¸Šæ˜¯ <code>nest</code> å…³äºæ§åˆ¶å™¨çš„åŸºç¡€ä»‹ç»ã€‚</li></ul> <h2 id="æä¾›è€…"><a href="#æä¾›è€…" class="header-anchor">#</a> æä¾›è€…</h2> <p><img src="https://docs.nestjs.com/assets/Components_1.png" alt="img" title="æä¾›è€…">
æ§åˆ¶å™¨åº”å¤„ç† <code>HTTP</code> è¯·æ±‚å¹¶å°†æ›´å¤æ‚çš„ä»»åŠ¡å§”æ‰˜ç»™ <code>Providers</code>ã€‚<code>Providers</code> åªæ˜¯ä¸€ä¸ªç”¨ <code>@Injectable()</code> è£…é¥°å™¨æ³¨é‡Šçš„ç±»ï¼Œæ˜¯çº¯ç²¹çš„ <code>JavaScript</code> ç±»ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">å¼ºçƒˆå»ºè®®</p> <p>ç”±äº <code>Nest</code> å¯ä»¥ä»¥æ›´å¤šçš„é¢å‘å¯¹è±¡æ–¹å¼è®¾è®¡å’Œç»„ç»‡ä¾èµ–æ€§,å› æ­¤è¯·æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œå¼ºçƒˆæ¨èæŒ‰ç…§<a href="https://zh.wikipedia.org/wiki/SOLID_(%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AE%BE%E8%AE%A1)" target="_blank" rel="noopener noreferrer">SOLID(å•ä¸€åŠŸèƒ½ã€å¼€é—­åŸåˆ™ã€é‡Œæ°æ›¿æ¢ã€æ¥å£éš”ç¦»ä»¥åŠä¾èµ–åè½¬)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>åŸåˆ™ã€‚</p></div> <h3 id="æœåŠ¡"><a href="#æœåŠ¡" class="header-anchor">#</a> æœåŠ¡</h3> <p>åˆ›å»ºä¸€ä¸ªç®€å•çš„æœåŠ¡ç¤ºä¾‹ï¼Œè¯¥æœåŠ¡å°†è´Ÿè´£æ•°æ®å­˜å‚¨å’Œæ£€ç´¢ï¼Œç”±å…¶ä½¿ç”¨ <code>CatsController</code>ï¼Œå› æ­¤å®ƒè¢«å®šä¹‰ä¸º <code>Provider</code> ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ªç±»æ¥è£…é¥° <code>@Injectable()</code>ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>cats.service.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Cat <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./interfaces/cat.interface'</span><span class="token punctuation">;</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsService</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">readonly</span> cats<span class="token operator">:</span> Cat<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">cat<span class="token operator">:</span> Cat</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cats<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Cat<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cats<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>è‹¥è¦ä½¿ç”¨ <code>CLI</code> åˆ›å»ºæœåŠ¡ç±»ï¼Œåªéœ€è¾“å…¥å‘½ä»¤ <code>$ nest g service cats</code>ã€‚</p></div> <p><code>CatsService</code> æ˜¯å…·æœ‰ä¸€ä¸ªå±æ€§å’Œä¸¤ä¸ªæ–¹æ³•çš„åŸºæœ¬ç±»ã€‚å”¯ä¸€çš„æ–°ç‰¹ç‚¹æ˜¯å®ƒä½¿ç”¨ <code>@Injectable()</code> è£…é¥°å™¨ã€‚è¯¥ <code>@Injectable()</code> é™„åŠ æœ‰å…ƒæ•°æ®ï¼Œå› æ­¤ Nest çŸ¥é“è¿™ä¸ªç±»æ˜¯ä¸€ä¸ª <code>Nest Provider</code>ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>ç¤ºä¾‹ä¸­çš„ <code>Cat</code> æ¥å£å¦‚ä¸‹</p></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  breed<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªæœåŠ¡ç±»æ¥æ£€ç´¢ <code>cats</code>,åœ¨ <code>CatsController</code> é‡Œä½¿ç”¨å¦‚ä¸‹</p> <div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <div class="language- extra-class"><pre><code>cats.controller.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Body <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateCatDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto/create-cat.dto'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Cat <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./interfaces/cat.interface'</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> catsService<span class="token operator">:</span> CatsService</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Cat<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é€šè¿‡ç±»æ„é€ å‡½æ•°æ³¨å…¥ <code>CatsService</code>, æ³¨æ„è¿™é‡Œçš„ <code>private</code> è¯­æ³•ï¼Œæ„å‘³ç€æˆ‘ä»¬å·²ç»åœ¨åŒä¸€ä½ç½®åˆ›å»ºå¹¶åˆå§‹åŒ–äº† <code>catsService</code> æˆå‘˜ã€‚</p> <h3 id="ä¾èµ–æ³¨å…¥"><a href="#ä¾èµ–æ³¨å…¥" class="header-anchor">#</a> ä¾èµ–æ³¨å…¥</h3> <p><code>Nest</code> å›´ç»•ç€<strong>ä¾èµ–æ³¨å…¥</strong>æ„å»ºï¼Œè¿™æ˜¯ä¸€ç§éå¸¸ä¼˜ç§€çš„è®¾è®¡æ¨¡å¼ï¼Œå…³äº<strong>ä¾èµ–æ³¨å…¥</strong>çš„ç›¸å…³æ–‡æ¡£å®˜æ–¹å»ºè®®å‚è€ƒ
<a href="https://angular.io/guide/dependency-injection" target="_blank" rel="noopener noreferrer">Aunglar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
å€ŸåŠ© <code>typescript</code> çš„ä¸€äº›ä¼˜ç§€çš„èƒ½åŠ›ï¼Œç®¡ç†ä¾èµ–é¡¹å˜å¾—å¾ˆå®¹æ˜“ï¼Œå› ä¸ºå®ƒä»¬æŒ‰ç±»å‹è§£æï¼Œä»¥ä¸‹ç¤ºä¾‹ <code>nest</code> å°†å±•ç¤ºé€šè¿‡åˆ›å»ºå¹¶è¿”å› <code>CatsService</code> çš„å®ä¾‹æ¥è§£æ <code>catsService</code>(åœ¨å•ä¾‹æ¨¡å¼ä¸‹ï¼Œå¦‚æœç°æœ‰å®ä¾‹åœ¨å…¶ä»–åœ°æ–¹è¢«è¯·æ±‚ï¼Œåˆ™è¿”å›è¯¥å®ä¾‹)ã€‚è§£ææ­¤ä¾èµ–å…³ç³»å¹¶å°†å…¶ä¼ é€’ç»™æ§åˆ¶å™¨çš„æ„é€ å‡½æ•°(æˆ–åˆ†é…ç»™æŒ‡å®šçš„å±æ€§)ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> catsService<span class="token operator">:</span> CatsService</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="ä½œç”¨åŸŸ-2"><a href="#ä½œç”¨åŸŸ-2" class="header-anchor">#</a> ä½œç”¨åŸŸ</h3> <p><code>Providers</code> é€šå¸¸å…·æœ‰ä¸åº”ç”¨ç¨‹åºåŒæ­¥çš„ç”Ÿå‘½å‘¨æœŸ(<code>ä½œç”¨åŸŸ</code>)ï¼Œç¨‹åºå¯åŠ¨æ—¶ï¼Œæ¯ä¸ªä¾èµ–éƒ½å¿…é¡»è¢«è§£æï¼Œå› æ­¤ï¼Œæ‰€æœ‰ <code>Provider</code> éƒ½è¦å®ä¾‹åŒ–ï¼ŒåŒæ ·ï¼Œå½“ç¨‹åºå…³é—­æ—¶ï¼Œæ¯ä¸ª <code>Provider</code> éƒ½è¦é”€æ¯æ‰ï¼Œä½†æ˜¯æœ‰äº›æ–¹æ³•å¯ä»¥æ”¹å˜ <code>provider</code> ç”Ÿå‘½å‘¨æœŸçš„è¯·æ±‚èŒƒå›´ï¼Œè¿™é‡Œæœ‰ç›¸å…³è¯¦ç»†<a href="https://docs.nestjs.com/fundamentals/injection-scopes" target="_blank" rel="noopener noreferrer">æ–‡æ¡£ ğŸ“š<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="è‡ªå®šä¹‰çš„-providers"><a href="#è‡ªå®šä¹‰çš„-providers" class="header-anchor">#</a> è‡ªå®šä¹‰çš„ Providers</h3> <p><code>Nest</code> æœ‰ä¸€ä¸ªå†…ç½®çš„åè½¬æ§åˆ¶å®¹å™¨( <code>IoC</code> ),å¯ä»¥è§£å†³ <code>Providers</code> ä¹‹é—´çš„å…³ç³»ï¼Œæ­¤åŠŸèƒ½æ˜¯ä¸Šè¿°<strong>ä¾èµ–é¡¹æ³¨</strong>å…¥åŠŸèƒ½çš„åŸºç¡€ï¼Œä½†å®é™…è¿œæ¯”ä¸Šè¿°å¼ºå¤§å¾—å¤šï¼Œ<code>@Injectable()</code> è£…é¥°å™¨ä»…ä»…æ˜¯å†°å±±ä¸€è§’ï¼Œå¹¶ä¸æ˜¯å®šä¹‰ <code>Providers</code> çš„å”¯ä¸€æ–¹æ³•ï¼Œä½ å¯ä»¥ä½¿ç”¨æ™®é€šçš„å€¼ã€ç±»ã€å¼‚æ­¥æˆ–åŒæ­¥å·¥å‚ã€‚æ›´å¤šçš„ç¤ºä¾‹<a href="https://docs.nestjs.com/fundamentals/dependency-injection" target="_blank" rel="noopener noreferrer">æ–‡æ¡£ ğŸ“š<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="å¯é€‰-providers"><a href="#å¯é€‰-providers" class="header-anchor">#</a> å¯é€‰ Providers</h3> <p>æœ‰æ—¶ï¼Œå¯èƒ½éœ€è¦è§£å†³ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ï¼Œä½ çš„ç±»å¯èƒ½å–å†³äºé…ç½®å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰ä¼ é€’ï¼Œåº”ä½¿ç”¨é»˜è®¤å€¼ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¾èµ–å…³ç³»ä¸ºå¯é€‰ï¼Œ<code>provider</code> ä¸ä¼šå› ä¸ºç¼ºå°‘é…ç½®å¯¼è‡´é”™è¯¯ã€‚
è¦æŒ‡ç¤º <code>provider</code> æ˜¯å¯é€‰çš„,åœ¨ <code>constructor</code> ä¸­ä½¿ç”¨ <code>@Optional()</code> è£…é¥°å™¨ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> Optional<span class="token punctuation">,</span> Inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HttpService</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>@<span class="token function">Optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span> @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token string">'HTTP_OPTIONS'</span><span class="token punctuation">)</span> <span class="token keyword">private</span> httpClient<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šé¢çš„ç¤ºä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨äº†è‡ªå®šçš„ <code>provider</code> ,è¿™æ˜¯æˆ‘ä»¬åŒ…å«è‡ªå®šä¹‰ <code>HTTP_OPTIONS</code> <strong>token</strong>çš„åŸå› ï¼Œå‰é¢çš„ç¤ºä¾‹æ˜¾ç¤ºäº†åŸºäºæ„é€ å‡½æ•°çš„æ³¨å…¥ï¼Œè¯¥æ³¨å…¥é€šè¿‡ä¾èµ–å‡½æ•°çš„ç±»è¿›è¡Œä¾èµ–ï¼Œæ›´å¤šçš„è‡ªå®šä¹‰ <code>Providers</code> å’Œç›¸å…³ <strong>tokens</strong>ä¿¡æ¯ <a href="https://docs.nestjs.com/fundamentals/custom-providers" target="_blank" rel="noopener noreferrer">ğŸ“š<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="åŸºäºå±æ€§çš„æ³¨å…¥"><a href="#åŸºäºå±æ€§çš„æ³¨å…¥" class="header-anchor">#</a> åŸºäºå±æ€§çš„æ³¨å…¥</h3> <p><code>Nest</code> åˆ°ç›®å‰ä¸ºæ­¢ä½¿ç”¨åŸºäºæ„é€ å‡½æ•°æ³¨å…¥çš„æŠ€æœ¯ï¼Œå³é€šè¿‡æ„é€ å‡½æ•°çš„æ–¹æ³•æ³¨å…¥ <code>providers</code> ,åœ¨ä¸€äº›ç‰¹æ®Šçš„åœºæ™¯ï¼ŒåŸºäºå±æ€§çš„æ³¨å…¥æ–¹å¼å˜å¾—æ›´å¥½ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé¡¶çº§ç±»ä¾èµ–ä¸ä¸€ä¸ªæˆ–å¤šä¸ª <code>providers</code>,é€šè¿‡ä»æ„é€ å‡½æ•°ä¸­è°ƒç”¨å­ç±»çš„ <code>super()</code> æ¥ä¼ é€’å®ƒä»¬å°±æ˜¾å¾—éå¸¸ç¹çï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥åœ¨å±æ€§ä¸Šä½¿ç”¨ <code>@Inject()</code> è£…é¥°å™¨ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> Inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HttpService</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token string">'HTTP_OPTIONS'</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token keyword">readonly</span> httpClient<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>å¦‚æœä½ çš„ç±»æ²¡æœ‰å…¶ä»– <code>provider</code> æ‰©å±•ï¼Œé‚£ä½ åº”è¯¥ä¸€ç›´ä½¿ç”¨<strong>åŸºäºæ„é€ å‡½æ•°</strong>çš„æ³¨å…¥æ–¹å¼ã€‚</p></div> <h3 id="æ³¨å†Œ-provider"><a href="#æ³¨å†Œ-provider" class="header-anchor">#</a> æ³¨å†Œ Provider</h3> <p>ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„æä¾›è€…<code>(CatsService)</code>,åŒæ—¶æˆ‘ä»¬æœ‰è¿™ä¸ªæœåŠ¡çš„ä½¿ç”¨è€… <code>(CatsController)</code>,æˆ‘ä»¬éœ€è¦å‘ <code>Nest</code> æ³¨å†Œè¯¥æœåŠ¡ï¼Œå·²ä¾¿èƒ½æ‰§è¡Œæ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–è¾‘æ¨¡å—æ–‡ä»¶ <code>(app.module.ts)</code> , ç„¶åå°†æœåŠ¡æ·»åŠ è‡³ <code>@Module()</code> è£…é¥°å™¨çš„ <code>providers</code> æ•°ç»„ä¸­ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>app.module.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats/cats.controller'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats/cats.service'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p><code>Nest</code> ç°åœ¨å¯ä»¥è§£æ <code>CatsController</code> ç±»çš„ä¾èµ–å…³ç³»äº†ã€‚ä»¥ä¸‹æ˜¯ç°åœ¨çš„ç›®å½•ç»“æ„:</p> <div class="language- extra-class"><pre class="language-text"><code>    src
    â”œâ”€â”€ cats
    â”‚    â”œâ”€â”€dto
    â”‚    â”‚   â””â”€â”€create-cat.dto.ts
    â”‚    â”œâ”€â”€ interfaces
    â”‚    â”‚       â””â”€â”€cat.interface.ts
    â”‚    â”œâ”€â”€cats.service.ts
    â”‚    â””â”€â”€cats.controller.ts
    â”œâ”€â”€app.module.ts
    â””â”€â”€main.ts
</code></pre></div><h3 id="æ‰‹åŠ¨å®ä¾‹åŒ–"><a href="#æ‰‹åŠ¨å®ä¾‹åŒ–" class="header-anchor">#</a> æ‰‹åŠ¨å®ä¾‹åŒ–</h3> <p>è¿„ä»Šï¼Œå·²è¿‘è®¨è®ºäº† <code>Nest</code> æ˜¯å¦‚ä½•è‡ªåŠ¨å¤„ç†å¹¶è§£æä¾èµ–é¡¹çš„å¤§éƒ¨åˆ†ç»†èŠ‚ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦è·³å‡ºå†…ç½®çš„ä¾èµ–æ³¨å…¥ç³»ç»Ÿï¼Œå¹¶æ‰‹åŠ¨æ£€ç´¢æˆ–å®ä¾‹åŒ–æä¾›ç¨‹åºï¼Œæˆ‘ä»¬åœ¨ä¸‹é¢ç®€è¦è®¨è®ºä¸¤ä¸ªè¿™æ ·çš„ä¸»é¢˜ã€‚</p> <p>è¦è·å–ç°æœ‰å®ä¾‹æˆ–åŠ¨æ€çš„å®ä¾‹æä¾›ç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://docs.nestjs.com/fundamentals/module-ref" target="_blank" rel="noopener noreferrer"><code>Module reference</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <p>åœ¨ <code>bootstrap()</code> å‡½æ•°ä¸­è·å–æä¾›ç¨‹åº(ä¾‹å¦‚ï¼Œå¯¹äºæ²¡æœ‰æ§åˆ¶å™¨çš„ç‹¬ç«‹åº”ç”¨ç¨‹åº,æˆ–åœ¨å¼•å¯¼è¿‡ç¨‹ä¸­ä½¿ç”¨é…ç½®æœåŠ¡),è¯·æŸ¥çœ‹<a href="https://docs.nestjs.com/standalone-applications" target="_blank" rel="noopener noreferrer"><code>Standalone applications</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h2 id="æ¨¡å—"><a href="#æ¨¡å—" class="header-anchor">#</a> æ¨¡å—</h2> <p>æ¨¡å—æ˜¯ç”¨ <code>@Module()</code> è£…é¥°å™¨æ³¨é‡Šçš„ç±»ï¼Œ<code>@Module()</code> è£…é¥°å™¨æä¾›äº†å…ƒæ•°æ®ï¼Œ <code>Nest</code> å¯ä»¥ç”¨å®ƒæ¥ç»„ç»‡åº”ç”¨ç¨‹åºçš„ç»“æ„ã€‚
<img src="https://docs.nestjs.com/assets/Modules_1.png" alt="img" title="æ¨¡å—"></p> <p>æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½æœ‰è‡³å°‘ä¸€ä¸ªæ¨¡å—å³<strong>æ ¹æ¨¡å—</strong>ï¼Œæ ¹æ¨¡å—æ˜¯ Nest å¼€å§‹å®‰æ’åº”ç”¨ç¨‹åºæ ‘çš„åœ°æ–¹,Nest ä¼šç”¨æ¥è§£ææ¨¡å—å’Œæä¾›è€…å…³ç³»ä»¥åŠä¾èµ–å…³ç³»çš„å†…éƒ¨æ•°æ®ç»“æ„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå½“åº”ç”¨ç¨‹åºå¾ˆå°æ—¶ï¼Œå¯èƒ½åªæœ‰æ ¹æ¨¡å—ã€‚æˆ‘ä»¬è¦å¼ºè°ƒï¼Œå¼ºçƒˆå»ºè®®å°†æ¨¡å—ä½œä¸ºç»„ç»‡ç»„ä»¶çš„æœ‰æ•ˆæ–¹æ³•ã€‚å› æ­¤ï¼Œå¯¹äºå¤§å¤šæ•°åº”ç”¨ï¼Œæœ€ç»ˆçš„æ¶æ„å°†é‡‡ç”¨å¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—å°è£…ä¸€ç»„ç´§å¯†ç›¸å…³çš„åŠŸèƒ½ã€‚</p> <p><code>@module()</code> è£…é¥°å™¨æ¥å—ä¸€ä¸ªæè¿°æ¨¡å—å±æ€§çš„å¯¹è±¡ï¼š</p> <table><thead><tr><th>å¯¹è±¡</th> <th style="text-align:center;">æè¿°</th></tr></thead> <tbody><tr><td><code>providers</code></td> <td style="text-align:center;">Nestæ³¨å…¥å™¨å°†å®ä¾‹åŒ–çš„æä¾›è€…ï¼Œå¹¶ä¸”è‡³å°‘å¯ä»¥åœ¨æ­¤æ¨¡å—ä¹‹é—´å…±äº«è¿™äº›æä¾›è€…</td></tr> <tr><td><code>controllers</code></td> <td style="text-align:center;">æ­¤æ¨¡å—ä¸­å®šä¹‰çš„å¿…é¡»å®ä¾‹åŒ–çš„ä¸€ç»„æ§åˆ¶å™¨</td></tr> <tr><td><code>imports</code></td> <td style="text-align:center;">å¯¼å…¥æ¨¡å—çš„åˆ—è¡¨,è¯¥æ¨¡å—å¯¼å‡ºæ‰€éœ€æä¾›ç¨‹åºçš„å¯¼å…¥æ¨¡å—åˆ—è¡¨</td></tr> <tr><td><code>exports</code></td> <td style="text-align:center;">ç”±æœ¬æ¨¡å—æä¾›å¹¶åº”åœ¨å…¶ä»–æ¨¡å—ä¸­å¯ç”¨çš„æä¾›è€…çš„å­é›†</td></tr></tbody></table> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥æ¨¡å—å°è£…æä¾›ç¨‹åºï¼Œè¿™æ„å‘³ç€æ— æ³•æ³¨å…¥æ—¢ä¸æ˜¯å½“å‰æ¨¡å—çš„ç›´æ¥ç»„æˆéƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯ä»å¯¼å…¥çš„æ¨¡å—å¯¼å‡ºçš„æä¾›ç¨‹åºï¼Œå› æ­¤ï¼Œå¯ä»¥å°†ä»æ¨¡å—å¯¼å‡ºçš„æä¾›ç¨‹åºè§†ä¸ºæ¨¡å—çš„å…¬å…±æ¥å£æˆ–APIã€‚</p> <h3 id="åŠŸèƒ½æ¨¡å—"><a href="#åŠŸèƒ½æ¨¡å—" class="header-anchor">#</a> åŠŸèƒ½æ¨¡å—</h3> <p><code>CatsController</code> å’Œ <code>CatsService</code> å±äºåŒä¸€åº”ç”¨ç¨‹åºåŸŸã€‚ç”±äºå®ƒä»¬å¯†åˆ‡ç›¸å…³ï¼Œåº”è¯¥è€ƒè™‘å°†å®ƒä»¬ç§»åŠ¨åˆ°ä¸€ä¸ªåŠŸèƒ½æ¨¡å—ä¸‹ï¼Œå³ CatsModuleã€‚åŠŸèƒ½æ¨¡å—ä»…ç»„ç»‡ä¸ç‰¹å®šåŠŸèƒ½ç›¸å…³çš„ä»£ç ï¼Œè¿™æ ·ç»„ç»‡åä»£ç æ›´æ¸…æ™°ï¼Œéšç€åº”ç”¨ç¨‹åºæˆ–å›¢é˜Ÿè§„æ¨¡çš„å¢é•¿ï¼Œæœ‰åŠ©äºæˆ‘ä»¬ç®¡ç†å¤æ‚æ€§å¹¶åˆ©ç”¨<a href="https://en.wikipedia.org/wiki/SOLID" target="_blank" rel="noopener noreferrer">SOLID<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>åŸç†è¿›è¡Œå¼€å‘ã€‚</p> <p>ä¸ºäº†å®ç°ä¸Šè¿°åŠŸèƒ½ï¼Œæ¼”ç¤ºåˆ›å»º <code>CatsModule</code></p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>cats/cats.module.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.controller'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.service'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>å¯ä»¥ä½¿ç”¨CLIåˆ›å»ºæ¨¡å—ï¼Œæ‰§è¡Œå‘½ä»¤ <code>$ nest g module cats</code></p></div> <p>ä»¥ä¸Šï¼Œæˆ‘ä»¬åœ¨ <code>cats.module.ts</code> æ–‡ä»¶ä¸­å®šä¹‰äº† <code>CatsModul</code>ï¼Œå¹¶å°†ä¸æ­¤æ¨¡å—ç›¸å…³çš„æ‰€æœ‰å†…å®¹ç§»è‡³ <code>cats</code> ç›®å½•ã€‚æœ€åå°†è¯¥æ¨¡å—å¯¼å…¥åˆ°æ ¹æ¨¡å—ä¸­(å³åœ¨ <code>app.module.ts</code> æ–‡ä»¶ä¸­å®šä¹‰çš„ <code>AppModule</code> å†…)ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats/cats.module'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>CatsModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>è¿™æ˜¯ç°åœ¨çš„ç›®å½•ç»“æ„æ ·å¼ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>    src
    â”œâ”€â”€cats
    â”‚    â”œâ”€â”€dto
    â”‚    â”‚   â””â”€â”€create-cat.dto.ts
    â”‚    â”œâ”€â”€interfaces
    â”‚    â”‚     â””â”€â”€cat.interface.ts
    â”‚    â”œâ”€cats.service.ts
    â”‚    â”œâ”€cats.controller.ts
    â”‚    â””â”€â”€cats.module.ts
    â”œâ”€â”€app.module.ts
    â””â”€â”€main.ts
</code></pre></div><h3 id="å…±äº«æ¨¡å—"><a href="#å…±äº«æ¨¡å—" class="header-anchor">#</a> å…±äº«æ¨¡å—</h3> <p>åœ¨Nestä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹æ¨¡å—æ˜¯<strong>å•ä¾‹</strong>ï¼Œå› æ­¤å¯ä»¥åœ¨å¤šä¸ªæ¨¡å—ä¹‹é—´å…±äº«ä»»ä½•æä¾›ç¨‹åºçš„ç›¸åŒå®ä¾‹ã€‚</p> <p><img src="https://docs.nestjs.com/assets/Shared_Module_1.png" alt="img" title="å…±äº«æ¨¡å—"></p> <p>æ¯ä¸ªæ¨¡å—è‡ªåŠ¨æ˜¯ä¸€ä¸ªå…±äº«æ¨¡å—ï¼Œåˆ›å»ºåï¼Œä»»ä½•æ¨¡å—å‡å¯é‡ç”¨ã€‚å‡è®¾è¦åœ¨å…¶ä»–æ¨¡å—ä¹‹é—´å…±äº« <code>CatsService</code>ï¼Œé¦–å…ˆéœ€è¦é€šè¿‡å°† <code>CatsService</code> æä¾›ç¨‹åºæ·»åŠ åˆ°æ¨¡å—çš„å¯¼å‡ºæ•°ç»„ä¸­æ¥å¯¼å‡ºï¼Œç¤ºä¾‹å¦‚ä¸‹:</p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>cats.module.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.controller'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.service'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span><span class="token punctuation">,</span>
  exports<span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨ï¼Œä»»ä½•å¯¼å…¥ <code>CatsModule</code> çš„æ¨¡å—éƒ½å¯ä»¥è®¿é—® <code>CatsService</code>ï¼Œå¹¶å°†ä¸å¯¼å…¥è¯¥æ¨¡å—çš„æ‰€æœ‰å…¶ä»–æ¨¡å—å…±äº«ã€‚</p> <h3 id="æ¨¡å—é‡æ–°å¯¼å‡º"><a href="#æ¨¡å—é‡æ–°å¯¼å‡º" class="header-anchor">#</a> æ¨¡å—é‡æ–°å¯¼å‡º</h3> <p>å¦‚ä¸Šæ‰€ç¤ºï¼Œæ¨¡å—å¯ä»¥å¯¼å‡ºå…¶å†…éƒ¨çš„æä¾›è€…ã€‚æ­¤å¤–ï¼Œä»–ä»¬å¯ä»¥é‡æ–°å¯¼å‡ºè‡ªå·±å¯¼å…¥çš„æ¨¡å—ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼Œ<code>CommonModule</code> æ—¢å¯ä»¥ä» <code>CoreModule</code> å¯¼å…¥ï¼Œä¹Ÿå¯ä»¥ä» <code>CoreModule</code> å¯¼å‡ºï¼Œä½¿å…¶å¯ç”¨äºå¯¼å…¥æ­¤æ¨¡å—çš„å…¶ä»–æ¨¡å—ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>CommonModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
  exports<span class="token operator">:</span> <span class="token punctuation">[</span>CommonModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CoreModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="ä¾èµ–æ³¨å…¥-2"><a href="#ä¾èµ–æ³¨å…¥-2" class="header-anchor">#</a> ä¾èµ–æ³¨å…¥</h3> <p>æ¨¡å—ç±»ä¹Ÿå¯ä»¥æ³¨å…¥æä¾›è€…(ä¾‹å¦‚ï¼Œå‡ºäºé…ç½®ç›®çš„)</p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>cats.module.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.controller'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.service'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsModule</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> catsService<span class="token operator">:</span> CatsService</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç„¶è€Œï¼Œç”±äº<a href="https://docs.nestjs.com/fundamentals/circular-dependency" target="_blank" rel="noopener noreferrer">å¾ªç¯ä¾èµ–<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œæ¨¡å—ç±»ä¸èƒ½æ³¨å…¥åˆ°æä¾›è€…ä¸­ã€‚</p> <h3 id="å…¨å±€æ¨¡å—"><a href="#å…¨å±€æ¨¡å—" class="header-anchor">#</a> å…¨å±€æ¨¡å—</h3> <p>å¦‚æœåœ¨å„å¤„å¯¼å…¥åŒä¸€ç»„æ¨¡å—,æ˜¾å¾—ç‰¹åˆ«ç¹çï¼Œä¸ <code>Angular</code> çš„å…¨å±€æ³¨å†Œä¸åŒï¼ŒNestå°†æä¾›ç¨‹åºå°è£…åœ¨æ¨¡å—èŒƒå›´å†…ï¼Œå¦‚æœä¸å…ˆå¯¼å…¥å°è£…æ¨¡å—ï¼Œå°±æ— æ³•åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨æ¨¡å—çš„æä¾›è€…ï¼Œä½†æœ‰æ—¶è¿™äº›æä¾›è€…è¦æ±‚å¼€ç®±å³ç”¨(ä¾‹å¦‚ helperï¼Œæ•°æ®åº“è¿æ¥ç­‰)ï¼Œå¯ä»¥ <code>ä½¿ç”¨@Global()</code> è£…é¥°å™¨å°†æ¨¡å—è®¾ç½®ä¸ºå…¨å±€ã€‚</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module<span class="token punctuation">,</span> Global <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.controller'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./cats.service'</span><span class="token punctuation">;</span>

@<span class="token function">Global</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span><span class="token punctuation">,</span>
  exports<span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p><code>@Global()</code> è£…é¥°å™¨ä½¿æ¨¡å—æˆä¸ºå…¨å±€ä½œç”¨åŸŸï¼Œå…¨å±€æ¨¡å—åªæ³¨å†Œä¸€æ¬¡ï¼Œé€šå¸¸ç”±æ ¹æˆ–æ ¸å¿ƒæ¨¡å—ç»„æˆã€‚ä¸Šé¢çš„ç¤ºä¾‹ï¼Œ <code>CatsService</code> æä¾›å•†å°†å¤„äºå…¨å±€æ¨¡å¼ï¼Œå¸Œæœ›æ³¨å…¥æœåŠ¡çš„æ¨¡å—å°†ä¸éœ€è¦åœ¨å…¶å¯¼å…¥æ•°ç»„ä¸­å¯¼å…¥ <code>CatsModule</code>ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>å…¨å±€æ¨¡å—å¯ç”¨äºå‡å°‘å¿…è¦çš„æ ·æ¿æ•°é‡ï¼Œä½†å¤§é‡ä½¿ç”¨å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„è®¾è®¡å†³ç­–ï¼Œå¯¼å…¥æ•°ç»„é€šå¸¸æ˜¯ä½¿æ¶ˆè´¹è€…å¯ä»¥ä½¿ç”¨æ¨¡å— API çš„é¦–é€‰æ–¹æ³•ã€‚</p></div> <h3 id="åŠ¨æ€æ¨¡å—"><a href="#åŠ¨æ€æ¨¡å—" class="header-anchor">#</a> åŠ¨æ€æ¨¡å—</h3> <p>åŠ¨æ€æ¨¡å—æ˜¯Nestæ¨¡å—ç³»ç»Ÿä¸­çš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è½»æ¾åˆ›å»ºå¯è‡ªå®šä¹‰çš„æ¨¡å—ï¼Œè¿™äº›æ¨¡å—å¯ä»¥åŠ¨æ€æ³¨å†Œå’Œé…ç½®æä¾›ç¨‹åºã€‚è¿™é‡Œæœ‰ç›¸å…³<a href="https://docs.nestjs.com/fundamentals/dynamic-modules" target="_blank" rel="noopener noreferrer">è¯¦ç»†ä»‹ç»<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œè¿™é‡Œåªåšç®€è¦æ¦‚å™ã€‚</p> <p>ä»¥ä¸‹æ˜¯ <code>DatabaseModule</code> çš„åŠ¨æ€æ¨¡å—å®šä¹‰çš„ç¤ºä¾‹ï¼š</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module<span class="token punctuation">,</span> DynamicModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createDatabaseProviders <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./database.providers'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Connection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./connection.provider'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>Connection<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DatabaseModule</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">forRoot</span><span class="token punctuation">(</span>entities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">:</span> DynamicModule <span class="token punctuation">{</span>
    <span class="token keyword">const</span> providers <span class="token operator">=</span> <span class="token function">createDatabaseProviders</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> entities<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token keyword">module</span><span class="token operator">:</span> DatabaseModule<span class="token punctuation">,</span>
      providers<span class="token operator">:</span> providers<span class="token punctuation">,</span>
      exports<span class="token operator">:</span> providers<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <div class="language- extra-class"><pre><code>`forRoot()` æ–¹æ³•å¯ä»¥åŒæ­¥æˆ–å¼‚æ­¥( `Promise` )è¿”å›åŠ¨æ€æ¨¡å—
</code></pre></div></div> <p>æ¨¡å—é»˜è®¤å®šä¹‰äº† <code>Connection</code> æä¾›ç¨‹åº(åœ¨ <code>@Module()</code> è£…é¥°å™¨å…ƒæ•°æ®ä¸­)ï¼Œæ­¤å¤–-æ ¹æ®ä¼ é€’ç»™æ–¹æ³•çš„ <code>entities</code> å’Œ <code>options</code> å¯¹è±¡ <code>forRoot()</code> -å…¬å¼€æä¾›ç¨‹åºçš„é›†åˆï¼Œä¾‹å¦‚å­˜å‚¨åº“ã€‚è¯·æ³¨æ„ï¼ŒåŠ¨æ€æ¨¡å—è¿”å›çš„æ˜¯å±æ€§æ‰©å±•è€Œä¸æ˜¯è¦†ç›–ï¼Œ<code>@Module()</code> è£…é¥°å™¨ä¸­å®šä¹‰çš„åŸºæœ¬æ¨¡å—å…ƒæ•°æ®ã€‚è¿™å°±æ˜¯ä»æ¨¡å—ä¸­å¯¼å‡ºé™æ€å£°æ˜çš„ <code>Connection</code> æä¾›ç¨‹åºå’ŒåŠ¨æ€ç”Ÿæˆçš„å­˜å‚¨åº“æä¾›ç¨‹åºçš„æ–¹å¼ã€‚</p> <p>å¦‚æœè¦åœ¨å…¨å±€èŒƒå›´å†…æ³¨å†ŒåŠ¨æ€æ¨¡å—ï¼Œå°† <code>global</code> å±æ€§è®¾ç½®ä¸º <code>true</code>å³å¯ï¼Œä¾‹ï¼š</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token punctuation">{</span>
  global<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">module</span><span class="token operator">:</span> DatabaseModule<span class="token punctuation">,</span>
  providers<span class="token operator">:</span> providers<span class="token punctuation">,</span>
  exports<span class="token operator">:</span> providers<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <div class="language- extra-class"><pre><code>æ­£å¦‚ä¸Šæ‰€è¿°ï¼Œå¤§é‡ä½¿ç”¨å…¨å±€æ³¨å†Œå¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„è®¾è®¡æ–¹å¼ã€‚
</code></pre></div></div> <p>å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼å¯¼å…¥å’Œé…ç½® <code>DatabaseModule</code>ï¼š</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> DatabaseModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./database/database.module'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> User <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./users/entities/user.entity'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>DatabaseModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">[</span>User<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>å¦‚æœæ‚¨æƒ³åè¿‡æ¥é‡æ–°å¯¼å‡ºåŠ¨æ€æ¨¡å—ï¼Œæ‚¨å¯ä»¥åœ¨ <code>exports</code> æ•°ç»„ä¸­çœç•¥ <code>forRoot()</code> æ–¹æ³•è°ƒç”¨ï¼š</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> DatabaseModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./database/database.module'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> User <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./users/entities/user.entity'</span><span class="token punctuation">;</span>

@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>DatabaseModule<span class="token punctuation">.</span><span class="token function">forRoot</span><span class="token punctuation">(</span><span class="token punctuation">[</span>User<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  exports<span class="token operator">:</span> <span class="token punctuation">[</span>DatabaseModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p><a href="https://docs.nestjs.com/fundamentals/dynamic-modules" target="_blank" rel="noopener noreferrer">åŠ¨æ€æ¨¡å—<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ä¸€ç« æœ‰æ›´è¯¦ç»†çš„ä»‹ç»ã€‚å¹¶åŒ…å«ä¸€ä¸ªå·¥ä½œ<a href="https://github.com/nestjs/nest/tree/master/sample/25-dynamic-modules" target="_blank" rel="noopener noreferrer">ç¤ºä¾‹<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h2 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="header-anchor">#</a> ä¸­é—´ä»¶</h2> <p>ä¸­é—´ä»¶æ˜¯åœ¨è·¯ç”±å¤„ç†ç¨‹åºä¹‹å‰è°ƒç”¨çš„å‡½æ•°ã€‚ä¸­é—´ä»¶åŠŸèƒ½å¯ä»¥è®¿é—®<a href="http://expressjs.com/en/4x/api.html#req" target="_blank" rel="noopener noreferrer">è¯·æ±‚<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>å’Œ<a href="http://expressjs.com/en/4x/api.html#res" target="_blank" rel="noopener noreferrer">å“åº”<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>å¯¹è±¡ï¼Œä»¥åŠåº”ç”¨ç¨‹åºçš„è¯·æ±‚-å“åº”å‘¨æœŸä¸­çš„ <code>next()</code> ä¸­é—´ä»¶åŠŸèƒ½ã€‚ä¸‹ä¸€ä¸ªä¸­é—´ä»¶åŠŸèƒ½é€šå¸¸ç”±åä¸º <code>next</code> çš„å˜é‡è¡¨ç¤ºã€‚</p> <p><img src="https://docs.nestjs.com/assets/Middlewares_1.png" alt="img" title="ä¸­é—´ä»¶"></p> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Nest</code> ä¸­é—´ä»¶ç­‰æ•ˆäº <code>Express</code>ä¸­é—´ä»¶ã€‚å®˜æ–¹æ–‡æ¡£ä¸­çš„ä»¥ä¸‹æè¿°æè¿°äº†ä¸­é—´ä»¶çš„åŠŸèƒ½ï¼š</p> <div class="custom-block tip"><p class="custom-block-title">ä¸­é—´ä»¶çš„åŠŸèƒ½ï¼š</p> <p>ä¸­é—´ä»¶åŠŸèƒ½å¯ä»¥æ‰§è¡Œä»¥ä¸‹ä»»åŠ¡ï¼š</p> <ul><li>æ‰§è¡Œä»»ä½•ä»£ç ã€‚</li> <li>æ›´æ”¹è¯·æ±‚å’Œå“åº”å¯¹è±¡ã€‚</li> <li>ç»“æŸè¯·æ±‚-å“åº”å‘¨æœŸã€‚</li> <li>è°ƒç”¨å †æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ã€‚</li> <li>å¦‚æœå½“å‰çš„ä¸­é—´ä»¶åŠŸèƒ½æ²¡æœ‰ç»“æŸè¯·æ±‚-å“åº”å‘¨æœŸï¼Œå®ƒå¿…é¡»è°ƒç”¨ <code>next()</code> æ‰èƒ½å°†æ§åˆ¶æƒä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ï¼Œå¦åˆ™ï¼Œè¯·æ±‚å°†è¢«æŒ‚èµ·ã€‚</li></ul></div> <p>æ‚¨å¯ä»¥åœ¨ä»»ä¸€å‡½æ•°ä¸­å®ç°è‡ªå®šä¹‰ <code>Nest</code> ä¸­é—´ä»¶ï¼Œæˆ–åœ¨å…·æœ‰ <code>@Injectable()</code> è£…é¥°å™¨çš„ç±»ä¸­ã€‚è¯¥ç±»åº”å®ç° <code>NestMiddleware</code> æ¥å£ï¼Œè€Œè¯¥åŠŸèƒ½æ²¡æœ‰ä»»ä½•ç‰¹æ®Šè¦æ±‚ï¼Œè®©æˆ‘ä»¬ä»ä½¿ç”¨ç±»æ–¹æ³•å®ç°ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶åŠŸèƒ½å¼€å§‹ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">å®˜æ–¹ç¤ºä¾‹</p> <div class="language- extra-class"><pre><code>logger.middleware.ts
</code></pre></div></div> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> NestMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Request<span class="token punctuation">,</span> Response <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LoggerMiddleware</span> <span class="token keyword">implements</span> <span class="token class-name">NestMiddleware</span> <span class="token punctuation">{</span>
  <span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token operator">:</span> Request<span class="token punctuation">,</span> res<span class="token operator">:</span> Response<span class="token punctuation">,</span> next<span class="token operator">:</span> <span class="token builtin">Function</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Request...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ä¾èµ–æ³¨å…¥-3"><a href="#ä¾èµ–æ³¨å…¥-3" class="header-anchor">#</a> ä¾èµ–æ³¨å…¥</h3></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/frontend-summary/zh/guide/nodejs.html" class="prev">
        Nodejs
      </a></span> <span class="next"><a href="/frontend-summary/zh/guide/ci.html">
        CI
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/frontend-summary/assets/js/app.b5f1b4da.js" defer></script><script src="/frontend-summary/assets/js/3.332dd64b.js" defer></script><script src="/frontend-summary/assets/js/20.9f755477.js" defer></script>
  </body>
</html>
